### 根据域名查找 IP 地址

#### 概念解释

IP 地址：IP 协议为互联网上的每一个网络和每一台主机分配的一个逻辑地址。IP 地址如同门牌号码，通过 IP 地址才能确定一台主机位置。服务器本质也是一台主机，想要访问某个服务器，必须先知道它的 IP 地址；

域名（ DN ）：IP 地址由四个数字组成，中间用点号连接，在使用过程中难记忆且易输入错误，所以用我们熟悉的字母和数字组合来代替纯数字的 IP 地址，比如我们只会记住 www.baidu.com（百度域名） 而不是 220.181.112.244（百度的其中一个 IP 地址）；

DNS： 每个域名都对应一个或多个提供相同服务服务器的 IP 地址，只有知道服务器 IP 地址才能建立连接，所以需要通过 DNS 把域名解析成一个 IP 地址。

知道了上面的概念，大概就知道了想要获得服务器的门牌号码，需要先将域名转换成 IP 地址。转换过程如下（以查询 www.baidu.com 的 IP 地址为例，其中2、3、4步均在上一步未查询成功的情况下进行）：

#### 查找过程

* 浏览器搜索自己的 DNS 缓存（维护一张域名与 IP 地址的对应表）；

* 搜索 操作系统中的 DNS 缓存（维护一张域名与 IP 地址的对应表）；

* 搜索 操作系统的 hosts 文件（ Windows 环境下，维护一张域名与 IP 地址的对应表）；

* 操作系统将域名发送至 LDNS（本地区域名服务器，如果你在学校接入互联网，则 LDNS 服务器就在学校，如果通过电信接入互联网，则 LDNS 服务器就在你当地的电信那里。）

* LDNS 查询自己的 DNS 缓存（一般查找成功率在 80% 左右），查找成功则返回结果，失败则发起一个迭代 DNS 解析请求；

* LDNS 向 Root Name Server （根域名服务器，其虽然没有每个域名的的具体信息，但存储了负责每个域，如 com、net、org等的解析的顶级域名服务器的地址）发起请求，此处，Root Name Server 返回 com 域的顶级域名服务器的地址；

* LDNS 向 com 域的顶级域名服务器发起请求，返回 baidu.com 域名服务器地址；

* LDNS 向 baidu.com 域名服务器发起请求，得到 www.baidu.com 的 IP 地址；（三级域名的查询其实是我们自己配置的，比如我购买了jgchen.xin,我可以给 www.jgchen.xin 这个域名配置一个 IP，然后还可以给别的三级域名配置一个 IP）

* LDNS 将得到的 IP 地址返回给操作系统，同时自己也将 IP 地址缓存起来；

* 操作系统将 IP 地址返回给浏览器，同时自己也将 IP 地址缓存起来；

* 至此，浏览器已经得到了域名对应的 IP 地址，将IP地址缓存起来，然后向该IP地址发起请求

